---
title: "P8105 HW3 mm6410"
author: "Mahdi Maktabi"
date: "2024-10-11"
output: github_document
---

```{r, message=FALSE}
library(tidyverse)
library(dplyr)
library(ggridges)
library(ggplot2)
```

## Problem 1





## Problem 2

Importing and cleaning *NHAMES Study* participant demographic and accelerometer data.

```{r}
demographics_df = 
  read_csv(
    file = "./data/nhanes_covar.csv",
    na = c("NA", ".", ""),
    skip = 4) |> 
  janitor::clean_names() |> 
  mutate(
    sex =
      case_match(
        sex,
        1 ~ "male",
        2 ~ "female"),
    sex = as.factor(sex))

accel_df =
  read_csv(
    file = "./data/nhanes_accel.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    min1:min1440,
    names_to = "min",
    names_prefix = "min",
    values_to = "min_value") |> 
  mutate(min = as.numeric(min))
```

Now I am merging the two datasets and excluded:

* Participants less than 21 years old
* Participants missing demographic data

```{r}
accel_tidy_df =
  bind_rows(demographics_df, accel_df) |> 
  janitor::clean_names() |>
  filter(age > 21, !is.na(sex), !is.na(age), !is.na(bmi), !is.na(education))
```

The code below will create a table that will show the number of men and women in each education category.

```{r}
accel_tidy_df |> 
  group_by(sex, education) |> 
  summarize(count = n(), .groups = 'drop') |> 
  mutate(
    education = case_when(
      education == 1 ~ "less than high school",
      education == 2 ~ "high school equivalent",
      education == 3 ~ "more than high school"
    )) |> 
  pivot_wider(
    names_from = education,
    values_from = count,
    values_fill = 0) |> 
  knitr::kable()
```

From the table, we can see that the distribution between each education category is fairly equal between male and females. There are slightly more males that have a high school equivalent education compared to females.

The code below will now show the age distribtuions for men and women in each age category.

```{r}
accel_tidy_df |> 
  mutate(
    education = case_when(
      education == 1 ~ "less than high school",
      education == 2 ~ "high school equivalent",
      education == 3 ~ "more than high school"
    )) |> 
  ggplot(aes(x = age, fill = sex)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~ education) +
  theme(legend.position = "bottom") +
  labs(
    x = "Age",
    y = "Density"
  )
```

Based on the graphs, we can see that:

* Less than high school: The distribtuion based on age are similar between sexes.
* High school equivalent: There are more older females than males and the distribution of females is slightly left-skewed.
* More than high school: The distribution between sexes is similar but there much more younger females than males. 

